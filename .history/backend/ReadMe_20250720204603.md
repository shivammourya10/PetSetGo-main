# PetSetGo Backend API

A comprehensive RESTful API for pet care management, built with Node.js, Express, and MongoDB. This backend provides features for pet management, breeding coordination, community forums, medical records, and veterinary resources.

## üöÄ Features

- **User Authentication** - JWT-based secure authentication
- **Pet Management** - CRUD operations for pet profiles
- **Pet Breeding System** - Matching and breeding request management
- **Community Forum** - Discussion categories, topics, and replies
- **Medical Records** - Digital prescription storage
- **Veterinary Articles** - News and tips from external APIs
- **File Upload** - Cloudinary integration for image storage
- **Input Validation** - Zod schema validation
- **Rate Limiting** - Login attempt protection

## üìã Prerequisites

- Node.js (v14.0.0 or higher)
- MongoDB (v4.4 or higher)
- Cloudinary account
- NewsAPI account (for vet articles)

## üõ†Ô∏è Installation & Setup

1. **Clone the repository**
```bash
git clone <repository-url>
cd PetSetGo-main/backend
```

2. **Install dependencies**
```bash
npm install
```

3. **Environment Configuration**
Create a `.env` file in the root directory:
```env
# Server Configuration
PORT=3000
NODE_ENV=development

# Database
MONGO_URI=mongodb+srv://username:password@cluster.mongodb.net/petsetgo

# JWT Configuration
ACCESS_TOKEN_SECRET=your_super_secret_jwt_key_min_32_chars
ACCESS_TOKEN_EXPIRY=1d

# Cloudinary Configuration
CLOUDINARY_API_NAME=your_cloudinary_cloud_name
CLOUDINARY_API_KEY=your_cloudinary_api_key
CLOUDINARY_API_SECRET=your_cloudinary_api_secret

# NewsAPI Configuration
NEWSAPI_KEY=your_newsapi_key
```

4. **Create required directories**
```bash
mkdir -p public/temp
```

5. **Start the server**
```bash
# Development mode
nodemon src/index.js

# Production mode
node src/index.js
```

The server will be running at `http://localhost:3000`

## üìö Complete API Documentation

### Base URL
- **URL**: `http://localhost:3000`

### Authentication

#### Register User

- **URL**: `/api/auth/register`
- **Method**: `POST`
- **Description**: Register a new user account
- **Authentication**: Not required
- **Request Body**:
  ```json
  {
    "email": "john.doe@example.com",
    "password": "securePass123",
    "name": "John Doe",
    "phoneNo": "1234567890",
    "userName": "johndoe"
  }
  ```
- **Response**:
  - **201 Created**: User registered successfully
  - **400 Bad Request**: Invalid input data or user already exists
  - **500 Server Error**: Registration failed

#### Login User

- **URL**: `/api/auth/login`
- **Method**: `POST`
- **Description**: Authenticate a user and receive access token
- **Authentication**: Not required
- **Rate Limit**: 5 attempts per 5 minutes per IP
- **Request Body**:
  ```json
  {
    "email": "john.doe@example.com",
    "password": "securePass123"
  }
  ```
- **Response**:
  - **200 OK**: Login successful, returns user data and access token
    ```json
    {
      "message": "Login successful",
      "user": {
        "id": "user_id",
        "email": "john.doe@example.com",
        "name": "John Doe",
        "userName": "johndoe"
      },
      "accessToken": "jwt_token_here"
    }
    ```
  - **401 Unauthorized**: Invalid credentials
  - **429 Too Many Requests**: Rate limit exceeded
  - **500 Server Error**: Login failed

#### Logout User

- **URL**: `/api/auth/logout`
- **Method**: `POST`
- **Description**: Logout user and invalidate token
- **Authentication**: Required (Bearer Token)
- **Response**:
  - **200 OK**: Logout successful
  - **401 Unauthorized**: Invalid or missing token
  - **500 Server Error**: Logout failed

### Pet Management

#### Create Pet

- **URL**: `/api/pets/{userId}/createPets`
- **Method**: `POST`
- **Description**: Add a new pet for a specific user
- **Authentication**: Required (Bearer Token)
- **Content-Type**: `multipart/form-data`
- **Request Body (Form Data)**:
  - **file**: Pet image (optional)
  - **name**: Pet name (string)
  - **species**: Pet species (string)
  - **breed**: Pet breed (string)
  - **age**: Pet age (number)
  - **gender**: Pet gender (string)
  - **description**: Pet description (string)
- **Response**:
  - **201 Created**: Pet created successfully
  - **400 Bad Request**: Invalid input data
  - **500 Server Error**: Creating pet failed

#### Get User's Pets

- **URL**: `/api/pets/{userId}/returnPets`
- **Method**: `GET`
- **Description**: Get all pets owned by a specific user
- **Authentication**: Required (Bearer Token)
- **Response**:
  - **200 OK**: Returns array of user's pets
    ```json
    {
      "data": [
        {
          "id": "pet_id",
          "name": "Fluffy",
          "species": "Cat",
          "breed": "Persian",
          "age": 3,
          "owner": "user_id",
          "imageUrl": "cloudinary_url"
        }
      ]
    }
    ```
  - **404 Not Found**: User not found
  - **500 Server Error**: Fetching pets failed

#### Get Single Pet

- **URL**: `/api/pets/{petId}`
- **Method**: `GET`
- **Description**: Get details of a specific pet
- **Authentication**: Required (Bearer Token)
- **Response**:
  - **200 OK**: Returns pet details
  - **404 Not Found**: Pet not found
  - **500 Server Error**: Fetching pet failed

#### Update Pet

- **URL**: `/api/pets/{petId}/updatePet`
- **Method**: `PUT`
- **Description**: Update a pet's information
- **Authentication**: Required (Bearer Token)
- **Content-Type**: `multipart/form-data`
- **Request Body (Form Data)**:
  - **file**: New pet image (optional)
  - **name**: Updated pet name (optional)
  - **species**: Updated species (optional)
  - **breed**: Updated breed (optional)
  - **age**: Updated age (optional)
- **Response**:
  - **200 OK**: Pet updated successfully
  - **400 Bad Request**: Invalid input data
  - **404 Not Found**: Pet not found
  - **500 Server Error**: Updating pet failed

#### Delete Pet

- **URL**: `/api/pets/{petId}`
- **Method**: `DELETE`
- **Description**: Delete a pet and remove from user's pet list
- **Authentication**: Required (Bearer Token)
- **Response**:
  - **200 OK**: Pet deleted successfully
  - **404 Not Found**: Pet not found
  - **500 Server Error**: Deleting pet failed

#### Update Pet Breeding Status

- **URL**: `/api/pets/{petId}/updateBreedingStatus`
- **Method**: `PUT`
- **Description**: Update pet's availability for breeding
- **Authentication**: Required (Bearer Token)
- **Request Body**:
  ```json
  {
    "breedingStatus": "available" | "unavailable" | "pregnant"
  }
  ```
- **Response**:
  - **200 OK**: Breeding status updated successfully
  - **400 Bad Request**: Invalid status
  - **404 Not Found**: Pet not found
  - **500 Server Error**: Update failed

### Rescue & Adoption Management

#### Submit Pet for Rescue/Adoption

- **URL**: `/api/pets/rescueAndAdoption`
- **Method**: `POST`
- **Description**: Submit a pet for rescue and adoption
- **Authentication**: Required (Bearer Token)
- **Content-Type**: `multipart/form-data`
- **Request Body (Form Data)**:
  - **file**: Pet image (required)
  - **name**: Pet name (string)
  - **species**: Pet species (string)
  - **breed**: Pet breed (string)
  - **age**: Pet age (number)
  - **description**: Pet description (string)
  - **location**: Pet location (string)
  - **contactInfo**: Contact information (string)
- **Response**:
  - **201 Created**: Pet submitted for adoption successfully
  - **400 Bad Request**: Invalid input data
  - **500 Server Error**: Submission failed

#### Get All Adoption Pets

- **URL**: `/api/pets/rescueAndAdoption`
- **Method**: `GET`
- **Description**: Get all pets available for adoption
- **Authentication**: Not required
- **Response**:
  - **200 OK**: Returns array of adoption pets
    ```json
    {
      "data": [
        {
          "id": "pet_id",
          "name": "Rescue Dog",
          "species": "Dog",
          "breed": "Mixed",
          "age": 2,
          "description": "Friendly rescue dog",
          "location": "City Center",
          "imageUrl": "cloudinary_url",
          "isAdopted": false
        }
      ]
    }
    ```
  - **500 Server Error**: Fetching adoption pets failed

#### Get Single Adoption Pet

- **URL**: `/api/pets/rescueAndAdoption/{petId}`
- **Method**: `GET`
- **Description**: Get details of a specific adoption pet
- **Authentication**: Not required
- **Response**:
  - **200 OK**: Returns adoption pet details
  - **404 Not Found**: Adoption pet not found
  - **500 Server Error**: Fetching pet failed

### Adoption Request Management

#### Submit Adoption Request

- **URL**: `/api/pets/adoption/request/{petId}`
- **Method**: `POST`
- **Description**: Submit an adoption request for a specific pet
- **Authentication**: Required (Bearer Token)
- **Request Body**:
  ```json
  {
    "reason": "Why you want to adopt this pet",
    "experience": "Your experience with pets",
    "livingArrangement": "Description of living situation"
  }
  ```
- **Response**:
  - **201 Created**: Adoption request submitted successfully
  - **400 Bad Request**: Invalid input data or pet already adopted
  - **404 Not Found**: Pet not found
  - **500 Server Error**: Request submission failed

#### Get User's Adoption Requests

- **URL**: `/api/pets/adoption/requests`
- **Method**: `GET`
- **Description**: Get all adoption requests made by the authenticated user
- **Authentication**: Required (Bearer Token)
- **Response**:
  - **200 OK**: Returns array of user's adoption requests
  - **500 Server Error**: Fetching requests failed

#### Get Single Adoption Request

- **URL**: `/api/pets/adoption/requests/{applicationId}`
- **Method**: `GET`
- **Description**: Get details of a specific adoption request
- **Authentication**: Required (Bearer Token)
- **Response**:
  - **200 OK**: Returns adoption request details
  - **404 Not Found**: Request not found
  - **500 Server Error**: Fetching request failed

#### Update Adoption Request Status

- **URL**: `/api/pets/adoption/requests/{applicationId}/status`
- **Method**: `PUT`
- **Description**: Update the status of an adoption request (for pet owners)
- **Authentication**: Required (Bearer Token)
- **Request Body**:
  ```json
  {
    "status": "approved" | "rejected" | "pending"
  }
  ```
- **Response**:
  - **200 OK**: Request status updated successfully
  - **400 Bad Request**: Invalid status
  - **404 Not Found**: Request not found
  - **500 Server Error**: Update failed
- **Description**: Get a list of breeding requests
- **Response**:
  - **200 OK**: Returns an array of breeding requests
  - **500 Server Error**: Fetching breeding requests failed

#### Update Breeding Request

- **URL**: `/api/breeding/:id`
- **Method**: `PUT`
- **Description**: Update a breeding request
- **Request Body**:
  ```json
  {
    "status": "string"
  }
  ```
- **Response**:
  - **200 OK**: Breeding request updated successfully
  - **400 Bad Request**: Invalid input data
  - **404 Not Found**: Breeding request not found
  - **500 Server Error**: Updating breeding request failed

#### Delete Breeding Request

- **URL**: `/api/breeding/:id`
- **Method**: `DELETE`
- **Description**: Delete a breeding request
- **Response**:
  - **204 No Content**: Breeding request deleted successfully
  - **404 Not Found**: Breeding request not found
  - **500 Server Error**: Deleting breeding request failed

### Forum Management

#### Create Topic

- **URL**: `/api/forum/topics`
- **Method**: `POST`
- **Description**: Create a new forum topic
- **Request Body**:
  ```json
  {
    "title": "string",
    "content": "string",
    "category": "string",
    "author": "user_id"
  }
  ```
- **Response**:
  - **201 Created**: Topic created successfully
  - **400 Bad Request**: Invalid input data
  - **500 Server Error**: Creating topic failed

#### Get Topics

- **URL**: `/api/forum/topics`
- **Method**: `GET`
- **Description**: Get a list of forum topics
- **Response**:
  - **200 OK**: Returns an array of forum topics
  - **500 Server Error**: Fetching topics failed

#### Update Topic

- **URL**: `/api/forum/topics/:id`
- **Method**: `PUT`
- **Description**: Update a forum topic
- **Request Body**:
  ```json
  {
    "title": "string",
    "content": "string"
  }
  ```
- **Response**:
  - **200 OK**: Topic updated successfully
  - **400 Bad Request**: Invalid input data
  - **404 Not Found**: Topic not found
  - **500 Server Error**: Updating topic failed

#### Delete Topic

- **URL**: `/api/forum/topics/:id`
- **Method**: `DELETE`
- **Description**: Delete a forum topic
- **Response**:
  - **204 No Content**: Topic deleted successfully
  - **404 Not Found**: Topic not found
  - **500 Server Error**: Deleting topic failed

#### Add Reply

- **URL**: `/api/forum/replies`
- **Method**: `POST`
- **Description**: Add a reply to a topic
- **Request Body**:
  ```json
  {
    "topicId": "string",
    "content": "string",
    "author": "user_id"
  }
  ```
- **Response**:
  - **201 Created**: Reply added successfully
  - **400 Bad Request**: Invalid input data
  - **500 Server Error**: Adding reply failed

#### Get Replies

- **URL**: `/api/forum/replies`
- **Method**: `GET`
- **Description**: Get replies for a topic
- **Response**:
  - **200 OK**: Returns an array of replies
  - **500 Server Error**: Fetching replies failed

### Medical Records

#### Add Medical Record

- **URL**: `/api/medical`
- **Method**: `POST`
- **Description**: Add a medical record for a pet
- **Request Body**:
  ```json
  {
    "petId": "string",
    "date": "string",
    "description": "string",
    "prescription": "string"
  }
  ```
- **Response**:
  - **201 Created**: Medical record added successfully
  - **400 Bad Request**: Invalid input data
  - **500 Server Error**: Adding medical record failed

#### Get Medical Records

- **URL**: `/api/medical`
- **Method**: `GET`
- **Description**: Get medical records for a pet
- **Response**:
  - **200 OK**: Returns an array of medical records
  - **500 Server Error**: Fetching medical records failed

### Veterinary Articles

#### Get Articles

- **URL**: `/api/articles`
- **Method**: `GET`
- **Description**: Get a list of veterinary articles
- **Response**:
  - **200 OK**: Returns an array of articles
  - **500 Server Error**: Fetching articles failed

### File Upload

#### Upload File

- **URL**: `/api/upload`
- **Method**: `POST`
- **Description**: Upload a file
- **Request Body**: `form-data`
  - **file**: The file to upload
- **Response**:
  - **200 OK**: Returns the uploaded file's information
  - **400 Bad Request**: Invalid file
  - **500 Server Error**: File upload failed

## üîë Authentication & Authorization

- All endpoints except **/api/auth/register** and **/api/auth/login** require authentication.
- Use the `Authorization` header with the `Bearer` scheme to access protected routes.

## üì¶ Technologies Used

- **Node.js** - JavaScript runtime
- **Express** - Web framework for Node.js
- **MongoDB** - NoSQL database
- **Mongoose** - MongoDB object modeling for Node.js
- **JWT** - JSON Web Tokens for authentication
- **Bcrypt** - Password hashing
- **Cloudinary** - Image and file storage
- **Zod** - TypeScript-first schema validation
- **Nodemon** - Development tool for auto-restarting the server

## üß™ Testing

- **Postman** - API testing
- **Jest** - JavaScript testing framework
- **Supertest** - HTTP assertions for testing

## üìà API Rate Limiting

- Rate limiting is applied to the login endpoint to prevent brute-force attacks.
- Configurable in the `src/middleware/rateLimiter.js` file.

## üìÇ Project Structure

```
PetSetGo-main/
‚îú‚îÄ‚îÄ backend/
‚îÇ   ‚îú‚îÄ‚îÄ config/              # Configuration files
‚îÇ   ‚îú‚îÄ‚îÄ controllers/         # Route controllers
‚îÇ   ‚îú‚îÄ‚îÄ middleware/          # Custom middleware
‚îÇ   ‚îú‚îÄ‚îÄ models/              # Mongoose models
‚îÇ   ‚îú‚îÄ‚îÄ routes/              # API routes
‚îÇ   ‚îú‚îÄ‚îÄ tests/               # Test files
‚îÇ   ‚îú‚îÄ‚îÄ uploads/             # Uploaded files
‚îÇ   ‚îú‚îÄ‚îÄ .env                  # Environment variables
‚îÇ   ‚îú‚îÄ‚îÄ .gitignore            # Git ignore file
‚îÇ   ‚îú‚îÄ‚îÄ package.json          # NPM package file
‚îÇ   ‚îî‚îÄ‚îÄ src/                 # Source files
‚îî‚îÄ‚îÄ README.md
```
